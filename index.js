$(() => {
    let Web3 = require("web3");
    let web3 = new Web3(new Web3.providers.HttpProvider('http://localhost:8545'));
    if (typeof window.web3 !== 'undefined')
    {
        injectedProvider = window.web3.currentProvider;
        web3 = new Web3(injectedProvider);
        console.log("injected provider used: " + injectedProvider);
    }
    else
    {
        alert("no injected provider found, using localhost:8545, please ensure your local node is running " +
            "and rpc and rpccorsdomain is enabled");
    }
    let tickets /* let of type bytes32[] here */ ;
    let nameOfContract /* let of type string here */ ;
    let symbolForContract /* let of type string here */ ;
    let organiserAddr /* let of type address here */ ;
    let paymasterAddr /* let of type address here */ ;
    let recipientAddr  /* let of type address here */ ;
    let state;
    let buildingName;
    let street;
    let defaultTickets = [
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7",
        "0x00000000000000000000000000000000EF6351E10000000000000000F7"
    ];

    function initWeb3() {
        //let's assume that coinbase is our account
        web3.eth.defaultAccount = web3.eth.coinbase;
        let address = web3.eth.defaultAccount;
        organiserAddr = $("#ownerAddress").val();
        paymasterAddr = address;
        recipientAddr = $("#recipientAddress").val();
        state = $("#state").val();
        buildingName = $("#building").val();
        street = $("#street").val();
        if(organiserAddr == "") organiserAddr = address;
        if(recipientAddr == "") recipientAddr = address;
        //once initialized, deploy
        deploy();
    }


    $("#deploy").click(() => {
        let eventDate = $("#eventDate").val();
        let dateTimeEvent = new Date(eventDate);
        //set all lets
        tickets = defaultTickets;
        nameOfContract = $("#eventName").val();
        symbolForContract = $("#ticketSymbol").val();
        //initialize web3 then deploy
        initWeb3();
    });

    function deploy() {
        $("#notice").show(); //let the user know that the contract is being deployed
        let tickets = tickets /* let of type uint256[] here */;
        let organiserAddr = organiserAddr/* let of type address here */;
        let paymasterAddr = paymasterAddr/* let of type address here */;
        let recipientAddr = recipientAddr/* let of type address here */;
        let streetName = street/* let of type string here */;
        let buildingName = buildingName/* let of type string here */;
        let stateName = state /* let of type string here */;
        let symbolName = symbolForContract/* let of type string here */;
        let contractName = nameOfContract /* let of type string here */;
        let ticketproContract = web3.eth.contract([ { "constant": false, "inputs": [ { "name": "expiry", "type": "uint256" }, { "name": "ticketIndices", "type": "uint256[]" }, { "name": "v", "type": "uint8" }, { "name": "r", "type": "bytes32" }, { "name": "s", "type": "bytes32" }, { "name": "recipient", "type": "address" } ], "name": "passTo", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [ { "name": "interfaceID", "type": "bytes4" } ], "name": "supportsInterface", "outputs": [ { "name": "", "type": "bool" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "name", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "getSymbol", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "paymaster", "outputs": [ { "name": "", "type": "address" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "ticket", "type": "uint256" } ], "name": "spawned", "outputs": [ { "name": "", "type": "bool" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "_to", "type": "address" }, { "name": "ticketIndices", "type": "uint256[]" } ], "name": "transfer", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [ { "name": "", "type": "uint256" } ], "name": "spawnedTickets", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "decimals", "outputs": [ { "name": "", "type": "uint8" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "getContractAddress", "outputs": [ { "name": "", "type": "address" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "tokenId", "type": "uint256" } ], "name": "getStreet", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "tokenId", "type": "uint256" } ], "name": "getState", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "expiry", "type": "uint256" }, { "name": "tickets", "type": "uint256[]" }, { "name": "v", "type": "uint8" }, { "name": "r", "type": "bytes32" }, { "name": "s", "type": "bytes32" }, { "name": "recipient", "type": "address" } ], "name": "spawnPassTo", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": false, "inputs": [ { "name": "tokenIds", "type": "uint256[]" } ], "name": "setExpired", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [], "name": "isStormBirdContract", "outputs": [ { "name": "", "type": "bool" } ], "payable": false, "stateMutability": "pure", "type": "function" }, { "constant": true, "inputs": [ { "name": "_owner", "type": "address" } ], "name": "balanceOf", "outputs": [ { "name": "", "type": "uint256[]" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "getAmountTransferred", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "street", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "expiry", "type": "uint256" }, { "name": "ticketIndices", "type": "uint256[]" }, { "name": "v", "type": "uint8" }, { "name": "r", "type": "bytes32" }, { "name": "s", "type": "bytes32" } ], "name": "trade", "outputs": [], "payable": true, "stateMutability": "payable", "type": "function" }, { "constant": true, "inputs": [], "name": "organiser", "outputs": [ { "name": "", "type": "address" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "symbol", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "tokenId", "type": "uint256" } ], "name": "getBuilding", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "tokenIds", "type": "uint256[]" }, { "name": "stateName", "type": "string" } ], "name": "setState", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "tokenIds", "type": "uint256[]" }, { "name": "buildingName", "type": "string" } ], "name": "setBuilding", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "tokenId", "type": "uint256" } ], "name": "expired", "outputs": [ { "name": "", "type": "bool" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [], "name": "endContract", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [], "name": "state", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "myBalance", "outputs": [ { "name": "", "type": "uint256[]" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "tickets", "type": "uint256[]" } ], "name": "loadNewTickets", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [], "name": "building", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "getDecimals", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "pure", "type": "function" }, { "constant": true, "inputs": [ { "name": "tokenIds", "type": "uint256[]" }, { "name": "streetName", "type": "string" } ], "name": "setStreet", "outputs": [ { "name": "", "type": "string" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "_from", "type": "address" }, { "name": "_to", "type": "address" }, { "name": "ticketIndices", "type": "uint256[]" } ], "name": "transferFrom", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "inputs": [ { "name": "tickets", "type": "uint256[]" }, { "name": "organiserAddr", "type": "address" }, { "name": "paymasterAddr", "type": "address" }, { "name": "recipientAddr", "type": "address" }, { "name": "streetName", "type": "string" }, { "name": "buildingName", "type": "string" }, { "name": "stateName", "type": "string" }, { "name": "symbolName", "type": "string" }, { "name": "contractName", "type": "string" } ], "payable": false, "stateMutability": "nonpayable", "type": "constructor" }, { "payable": true, "stateMutability": "payable", "type": "fallback" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "_to", "type": "address" }, { "indexed": false, "name": "count", "type": "uint256" } ], "name": "Transfer", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "_from", "type": "address" }, { "indexed": true, "name": "_to", "type": "address" }, { "indexed": false, "name": "count", "type": "uint256" } ], "name": "TransferFrom", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "seller", "type": "address" }, { "indexed": false, "name": "ticketIndices", "type": "uint256[]" }, { "indexed": false, "name": "v", "type": "uint8" }, { "indexed": false, "name": "r", "type": "bytes32" }, { "indexed": false, "name": "s", "type": "bytes32" } ], "name": "Trade", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": false, "name": "ticketIndices", "type": "uint256[]" }, { "indexed": false, "name": "v", "type": "uint8" }, { "indexed": false, "name": "r", "type": "bytes32" }, { "indexed": false, "name": "s", "type": "bytes32" }, { "indexed": true, "name": "recipient", "type": "address" } ], "name": "PassTo", "type": "event" } ]);
        let ticketpro = ticketproContract.new(
            tickets,
            organiserAddr,
            paymasterAddr,
            recipientAddr,
            streetName,
            buildingName,
            stateName,
            symbolName,
            contractName,
            {
                from: web3.eth.accounts[0],
                data: '0x608060405260006005556000600760006101000a81548160ff02191690831515021790555060405180807f62616c616e63654f66286164647265737329000000000000000000000000000081525060120190506040518091039020600c60006101000a81548163ffffffff02191690837c01000000000000000000000000000000000000000000000000000000009004021790555060405180807f74726164652875696e743235362c75696e743235365b5d2c75696e74382c627981526020017f74657333322c6279746573333229000000000000000000000000000000000000815250602e0190506040518091039020600c60046101000a81548163ffffffff02191690837c01000000000000000000000000000000000000000000000000000000009004021790555060405180807f70617373546f2875696e743235362c75696e743235365b5d2c75696e74382c6281526020017f7974657333322c627974657333322c616464726573732900000000000000000081525060370190506040518091039020600c60086101000a81548163ffffffff02191690837c01000000000000000000000000000000000000000000000000000000009004021790555060405180807f737061776e50617373546f2875696e743235362c75696e743235365b5d2c756981526020017f6e74382c627974657333322c627974657333322c616464726573732900000000815250603c0190506040518091039020600c806101000a81548163ffffffff02191690837c0100000000000000000000000000000000000000000000000000000000900402179055503480156200026257600080fd5b5060405162003a0a38038062003a0a83398101806040528101908080518201929190602001805190602001909291908051906020019092919080519060200190929190805182019291906020018051820192919060200180518201929190602001805182019291906020018051820192919050505087600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555086600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550886000808873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000209080519060200190620003ad9291906200043a565b508460099080519060200190620003c69291906200048c565b5083600a9080519060200190620003df9291906200048c565b508260089080519060200190620003f89291906200048c565b5081600b9080519060200190620004119291906200048c565b5080600690805190602001906200042a9291906200048c565b505050505050505050506200053b565b82805482825590600052602060002090810192821562000479579160200282015b82811115620004785782518255916020019190600101906200045b565b5b50905062000488919062000513565b5090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10620004cf57805160ff191683800117855562000500565b8280016001018555821562000500579182015b82811115620004ff578251825591602001919060010190620004e2565b5b5090506200050f919062000513565b5090565b6200053891905b80821115620005345760008160009055506001016200051a565b5090565b90565b6134bf806200054b6000396000f3006080604052600436106101a1576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063015a0488146101a657806301ffc9a71461025f57806306fdde03146102c3578063150704011461035357806316e4cbf9146103e35780631bb750821461043a5780632b4e4e961461047f5780633095c1ad14610505578063313ce5671461054657806332a2c5d01461057757806340c1b7ad146105ce57806344c9af28146106745780634bd13cdd1461071a5780634cfd6286146107d35780634f452b9a1461083957806370a082311461086857806372c5cb6314610900578063741966261461092b5780637a230791146109bb5780637e53748614610a4757806395d89b4114610a9e5780639dfd8b0214610b2e578063a75186c714610bd4578063b961de4414610cf9578063ba065e1f14610e1e578063bb6e7de914610e63578063c19d93fb14610e7a578063c9116b6914610f0a578063cf0b41a314610f76578063e7dc333614610fdc578063f0141d841461106c578063f6be7ed314611097578063fe60ebdc146111bc575b600080fd5b3480156101b257600080fd5b5061025d6004803603810190808035906020019092919080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290803560ff16906020019092919080356000191690602001909291908035600019169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050611262565b005b34801561026b57600080fd5b506102a960048036038101908080357bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690602001909291905050506115ea565b604051808215151515815260200191505060405180910390f35b3480156102cf57600080fd5b506102d86117c8565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156103185780820151818401526020810190506102fd565b50505050905090810190601f1680156103455780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561035f57600080fd5b5061036861186a565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156103a857808201518184015260208101905061038d565b50505050905090810190601f1680156103d55780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156103ef57600080fd5b506103f861190c565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561044657600080fd5b5061046560048036038101908080359060200190929190505050611932565b604051808215151515815260200191505060405180910390f35b34801561048b57600080fd5b50610503600480360381019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290505050611989565b005b34801561051157600080fd5b5061053060048036038101908080359060200190929190505050611b91565b6040518082815260200191505060405180910390f35b34801561055257600080fd5b5061055b611bb4565b604051808260ff1660ff16815260200191505060405180910390f35b34801561058357600080fd5b5061058c611bb9565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3480156105da57600080fd5b506105f960048036038101908080359060200190929190505050611bc1565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561063957808201518184015260208101905061061e565b50505050905090810190601f1680156106665780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561068057600080fd5b5061069f60048036038101908080359060200190929190505050611c65565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156106df5780820151818401526020810190506106c4565b50505050905090810190601f16801561070c5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561072657600080fd5b506107d16004803603810190808035906020019092919080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290803560ff16906020019092919080356000191690602001909291908035600019169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050611d09565b005b3480156107df57600080fd5b5061083760048036038101908080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290505050611f31565b005b34801561084557600080fd5b5061084e611fab565b604051808215151515815260200191505060405180910390f35b34801561087457600080fd5b506108a9600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050611fb4565b6040518080602001828103825283818151815260200191508051906020019060200280838360005b838110156108ec5780820151818401526020810190506108d1565b505050509050019250505060405180910390f35b34801561090c57600080fd5b5061091561204a565b6040518082815260200191505060405180910390f35b34801561093757600080fd5b50610940612054565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610980578082015181840152602081019050610965565b50505050905090810190601f1680156109ad5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b610a456004803603810190808035906020019092919080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290803560ff169060200190929190803560001916906020019092919080356000191690602001909291905050506120f2565b005b348015610a5357600080fd5b50610a5c61245d565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b348015610aaa57600080fd5b50610ab3612483565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610af3578082015181840152602081019050610ad8565b50505050905090810190601f168015610b205780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b348015610b3a57600080fd5b50610b5960048036038101908080359060200190929190505050612521565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610b99578082015181840152602081019050610b7e565b50505050905090810190601f168015610bc65780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b348015610be057600080fd5b50610c7e60048036038101908080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192905050506125c5565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610cbe578082015181840152602081019050610ca3565b50505050905090810190601f168015610ceb5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b348015610d0557600080fd5b50610da360048036038101908080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050612640565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610de3578082015181840152602081019050610dc8565b50505050905090810190601f168015610e105780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b348015610e2a57600080fd5b50610e49600480360381019080803590602001909291905050506126bb565b604051808215151515815260200191505060405180910390f35b348015610e6f57600080fd5b50610e786126c5565b005b348015610e8657600080fd5b50610e8f61275c565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610ecf578082015181840152602081019050610eb4565b50505050905090810190601f168015610efc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b348015610f1657600080fd5b50610f1f6127fa565b6040518080602001828103825283818151815260200191508051906020019060200280838360005b83811015610f62578082015181840152602081019050610f47565b505050509050019250505060405180910390f35b348015610f8257600080fd5b50610fda6004803603810190808035906020019082018035906020019080806020026020016040519081016040528093929190818152602001838360200280828437820191505050505050919291929050505061288e565b005b348015610fe857600080fd5b50610ff16129ac565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015611031578082015181840152602081019050611016565b50505050905090810190601f16801561105e5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561107857600080fd5b50611081612a4a565b6040518082815260200191505060405180910390f35b3480156110a357600080fd5b5061114160048036038101908080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050612a55565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015611181578082015181840152602081019050611166565b50505050905090810190601f1680156111ae5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156111c857600080fd5b50611260600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290505050612ad0565b005b6000806000806000600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156112c657600080fd5b428b11806112d4575060008b145b15156112df57600080fd5b6112eb60008c8c612d4c565b94506001858a8a8a604051600081526020016040526040518085600019166000191681526020018460ff1660ff1681526020018360001916600019168152602001826000191660001916815260200194505050505060206040516020810390808403906000865af1158015611364573d6000803e3d6000fd5b505050602060405103519350600092505b895183101561152057898381518110151561138c57fe5b90602001906020020151915060008060008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020838154811015156113e557fe5b9060005260206000200154141515156113fa57fe5b6000808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208281548110151561144557fe5b906000526020600020015490506000808773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190806001815401808255809150509060018203906000526020600020016000909192909190915055506000808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208281548110151561150557fe5b90600052602060002001600090558280600101935050611375565b8573ffffffffffffffffffffffffffffffffffffffff167fcf7370598f037d339864eec2202ca184ad6af5b4a0f56335d83f97ed76bafcc08b8b8b8b60405180806020018560ff1660ff16815260200184600019166000191681526020018360001916600019168152602001828103825286818151815260200191508051906020019060200280838360005b838110156115c75780820151818401526020810190506115ac565b505050509050019550505050505060405180910390a25050505050505050505050565b6000600c60009054906101000a90047c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614806116cb5750600c60049054906101000a90047c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b8061173e5750600c60089054906101000a90047c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b806117b05750600c809054906101000a90047c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b156117be57600190506117c3565b600090505b919050565b606060068054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156118605780601f1061183557610100808354040283529160200191611860565b820191906000526020600020905b81548152906001019060200180831161184357829003601f168201915b5050505050905090565b6060600b8054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156119025780601f106118d757610100808354040283529160200191611902565b820191906000526020600020905b8154815290600101906020018083116118e557829003601f168201915b5050505050905090565b600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600080600090505b60018054905081101561197e578260018281548110151561195757fe5b906000526020600020015414156119715760019150611983565b808060010191505061193a565b600091505b50919050565b600080600091505b8251821015611b3c5782828151811015156119a857fe5b90602001906020020151905060008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002082815481101515611a0157fe5b906000526020600020015414151515611a1957600080fd5b6000808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002082815481101515611aa257fe5b906000526020600020015490806001815401808255809150509060018203906000526020600020016000909192909190915055506000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081815481101515611b2157fe5b90600052602060002001600090558180600101925050611991565b8373ffffffffffffffffffffffffffffffffffffffff167f69ca02dd4edd7bf0a4abb9ed3b7af3f14778db5d61921c7dc7cd545266326de284516040518082815260200191505060405180910390a250505050565b600181815481101515611ba057fe5b906000526020600020016000915090505481565b600081565b600030905090565b606060098054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611c595780601f10611c2e57610100808354040283529160200191611c59565b820191906000526020600020905b815481529060010190602001808311611c3c57829003601f168201915b50505050509050919050565b606060088054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611cfd5780601f10611cd257610100808354040283529160200191611cfd565b820191906000526020600020905b815481529060010190602001808311611ce057829003601f168201915b50505050509050919050565b600080600042891180611d1c5750600089145b1515611d2757600080fd5b611d3360008a8a61307e565b9250600183888888604051600081526020016040526040518085600019166000191681526020018460ff1660ff1681526020018360001916600019168152602001826000191660001916815260200194505050505060206040516020810390808403906000865af1158015611dac573d6000803e3d6000fd5b505050602060405103519150600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16141515611e1457600080fd5b60026000866000191660001916815260200190815260200160002060009054906101000a900460ff16151515611e4957600080fd5b600090505b8751811015611f26576000808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208882815181101515611ea357fe5b90602001906020020151908060018154018082558091505090600182039060005260206000200160009091929091909150555060018882815181101515611ee657fe5b9060200190602002015190806001815401808255809150509060018203906000526020600020016000909192909190915055508080600101915050611e4e565b505050505050505050565b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515611f8d57600080fd5b6001600760006101000a81548160ff02191690831515021790555050565b60006001905090565b60606000808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002080548060200260200160405190810160405280929190818152602001828054801561203e57602002820191906000526020600020905b81548152602001906001019080831161202a575b50505050509050919050565b6000600554905090565b60098054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156120ea5780601f106120bf576101008083540402835291602001916120ea565b820191906000526020600020905b8154815290600101906020018083116120cd57829003601f168201915b505050505081565b600080600080428911806121065750600089145b151561211157600080fd5b61211c348a8a612d4c565b9350600184888888604051600081526020016040526040518085600019166000191681526020018460ff1660ff1681526020018360001916600019168152602001826000191660001916815260200194505050505060206040516020810390808403906000865af1158015612195573d6000803e3d6000fd5b505050602060405103519250600091505b875182101561234e5787828151811015156121bd57fe5b90602001906020020151905060008060008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208281548110151561221657fe5b90600052602060002001541415151561222b57fe5b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020828154811015156122b457fe5b906000526020600020015490806001815401808255809150509060018203906000526020600020016000909192909190915055506000808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208181548110151561233357fe5b906000526020600020016000905581806001019250506121a6565b8273ffffffffffffffffffffffffffffffffffffffff166108fc349081150290604051600060405180830381858888f19350505050158015612394573d6000803e3d6000fd5b508273ffffffffffffffffffffffffffffffffffffffff167f951553379d49c26bc057f41de147adc24a09bda33b6b23374354bfbfb96edae88989898960405180806020018560ff1660ff16815260200184600019166000191681526020018360001916600019168152602001828103825286818151815260200191508051906020019060200280838360005b8381101561243c578082015181840152602081019050612421565b505050509050019550505050505060405180910390a2505050505050505050565b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600b8054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156125195780601f106124ee57610100808354040283529160200191612519565b820191906000526020600020905b8154815290600101906020018083116124fc57829003601f168201915b505050505081565b6060600a8054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156125b95780601f1061258e576101008083540402835291602001916125b9565b820191906000526020600020905b81548152906001019060200180831161259c57829003601f168201915b50505050509050919050565b6060600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561262357600080fd5b81600890805190602001906126399291906133ee565b5092915050565b6060600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561269e57600080fd5b81600a90805190602001906126b49291906133ee565b5092915050565b6000809050919050565b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561272157600080fd5b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16ff5b60088054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156127f25780601f106127c7576101008083540402835291602001916127f2565b820191906000526020600020905b8154815290600101906020018083116127d557829003601f168201915b505050505081565b60606000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002080548060200260200160405190810160405280929190818152602001828054801561288457602002820191906000526020600020905b815481526020019060010190808311612870575b5050505050905090565b6000600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156128ec57600080fd5b600090505b81518110156129a857600080600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020828281518110151561296857fe5b90602001906020020151908060018154018082558091505090600182039060005260206000200160009091929091909150555080806001019150506128f1565b5050565b600a8054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612a425780601f10612a1757610100808354040283529160200191612a42565b820191906000526020600020905b815481529060010190602001808311612a2557829003601f168201915b505050505081565b60008060ff16905090565b6060600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515612ab357600080fd5b8160099080519060200190612ac99291906133ee565b5092915050565b600080600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515612b2f57600080fd5b600091505b8251821015612cdf578282815181101515612b4b57fe5b90602001906020020151905060008060008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002082815481101515612ba457fe5b906000526020600020015414151515612bbc57600080fd5b6000808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002082815481101515612c4557fe5b906000526020600020015490806001815401808255809150509060018203906000526020600020016000909192909190915055506000808673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081815481101515612cc457fe5b90600052602060002001600090558180600101925050612b34565b8373ffffffffffffffffffffffffffffffffffffffff168573ffffffffffffffffffffffffffffffffffffffff167fc0d84ce5c7ff9ca21adb0f8436ff3f4951b4bb78c4e2fae2b6837958b3946ffd85516040518082815260200191505060405180910390a35050505050565b6000606060008060028551026054016040519080825280601f01601f191660200182016040528015612d8d5781602001602082028038833980820191505090505b509250612d98611bb9565b9150600090505b6020811015612e005780600802879060020a026001028382815181101515612dc357fe5b9060200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508080600101915050612d9f565b600090505b6020811015612e695780600802869060020a026001028360208301815181101515612e2c57fe5b9060200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508080600101915050612e05565b600090505b6014811015612eed5780600802826c01000000000000000000000000026bffffffffffffffffffffffff19169060020a028382604001815181101515612eb057fe5b9060200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508080600101915050612e6e565b600090505b845181101561300f5760088582815181101515612f0b57fe5b906020019060200201519060020a90047f0100000000000000000000000000000000000000000000000000000000000000028360028302605401815181101515612f5157fe5b9060200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508481815181101515612f8f57fe5b906020019060200201517f0100000000000000000000000000000000000000000000000000000000000000028360016002840260540101815181101515612fd257fe5b9060200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508080600101915050612ef2565b826040518082805190602001908083835b6020831015156130455780518252602082019150602081019050602083039250613020565b6001836020036101000a038019825116818451168082178552505050505050905001915050604051809103902093505050509392505050565b60006060600080600060208651026054016040519080825280601f01601f1916602001820160405280156130c15781602001602082028038833980820191505090505b5093506130cc611bb9565b9250600091505b60208210156131345781600802889060020a0260010284838151811015156130f757fe5b9060200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a90535081806001019250506130d3565b600091505b602082101561319d5781600802879060020a02600102846020840181518110151561316057fe5b9060200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508180600101925050613139565b600091505b60148210156132215781600802836c01000000000000000000000000026bffffffffffffffffffffffff19169060020a0284836040018151811015156131e457fe5b9060200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a90535081806001019250506131a2565b600091505b855182101561337e57858281518110151561323d57fe5b906020019060200201517f01000000000000000000000000000000000000000000000000000000000000000284601f602085026054010181518110151561328057fe5b9060200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350600190505b602081101561337157600886838151811015156132ce57fe5b906020019060200201519060020a900486838151811015156132ec57fe5b906020019060200201818152507f0100000000000000000000000000000000000000000000000000000000000000028482601f60208602605401010381518110151561333457fe5b9060200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a90535080806001019150506132b5565b8180600101925050613226565b836040518082805190602001908083835b6020831015156133b4578051825260208201915060208101905060208303925061338f565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390209450505050509392505050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061342f57805160ff191683800117855561345d565b8280016001018555821561345d579182015b8281111561345c578251825591602001919060010190613441565b5b50905061346a919061346e565b5090565b61349091905b8082111561348c576000816000905550600101613474565b5090565b905600a165627a7a72305820e2257339ddb91f46b3487d5d836bbe0712d8446525c7bc6199abd5227ddbacc10029',
                gas: '4700000'
            }, function (e, contract) {
                console.log(e, contract);
                if (e) {
                    alert(e);
                    return;
                }
                if (typeof contract.address !== 'undefined') {
                    alert('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
                    //set xcontract button
                    $("#viewOnXContract").show().click(() => {
                        let url = "https://xcontract.herokuapp.com/api/" + JSON.stringify(ticketpro.abi) + "/" + contract.address;
                        window.location.href = url
                    });
                    $("#viewOnEtherscan").show().click(() => {
                        redirectToEtherscan(contract.address);
                    });
                }
            });
    }


    function redirectToEtherscan(address)
    {
        web3.version.getNetwork((err, networkId) => {
            if (networkId == 3) window.location.href = "https://ropsten.etherscan.io/address/" + address;
            else if (networkId == 4) window.location.href = "https://rinkeby.etherscan.io/address/" + address;
            else if (networkId == 42) window.location.href = "https://kovan.etherscan.io/address/" + address;
            else window.location.href = "https://etherscan.io/address/" + address;
        });
    }
});
